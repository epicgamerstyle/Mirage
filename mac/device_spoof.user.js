// ==UserScript==
// @name         Device Fingerprint Spoof
// @version      1.0
// @description  Override JS fingerprints to match spoofed device profile
// @match        *://*/*
// @run-at       document-start
// ==/UserScript==

// Cromite 144+ blocks <script> tag injection from the isolated world.
// Use div.click() + onclick attribute for synchronous MAIN world execution.
// The onclick handler runs in the page's MAIN JS context, allowing us to
// override window, navigator, screen, and other page-level objects.

(function() {
    var _p = "(function() {\n        'use strict';\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 0. CORE INFRASTRUCTURE\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        var _origFns = new Map();\n        function _storeOrig(fn, name) { _origFns.set(fn, name); }\n\n        var _origToStr = Function.prototype.toString;\n        var _newToStr = function() {\n            if (_origFns.has(this)) {\n                return 'function ' + _origFns.get(this) + '() { [native code] }';\n            }\n            return _origToStr.call(this);\n        };\n        Function.prototype.toString = _newToStr;\n        _origFns.set(_newToStr, 'toString');\n\n        var _s = 2752919560 >>> 0;\n        function _rng() { _s = (_s * 1664525 + 1013904223) >>> 0; return _s; }\n        function _noiseF() { return ((_rng() / 0xFFFFFFFF) - 0.5) * 0.00008; }\n\n        function _def(obj, prop, val) {\n            try {\n                var _getter = function() { return val; };\n                _storeOrig(_getter, 'get ' + prop);\n                Object.defineProperty(obj, prop, {\n                    get: _getter,\n                    configurable: false,\n                    enumerable: true,\n                });\n            } catch(e) {}\n        }\n\n        var _origPerfNow = Performance.prototype.now;\n\n        // \u2500\u2500 navigator.webdriver = false \u2500\u2500\n        try {\n            delete Navigator.prototype.webdriver;\n            var _getWebdriver = function() { return false; };\n            _storeOrig(_getWebdriver, 'get webdriver');\n            Object.defineProperty(Navigator.prototype, 'webdriver', {\n                get: _getWebdriver,\n                configurable: true,\n                enumerable: true,\n            });\n        } catch(e) {}\n\n        // \u2500\u2500 Notification.permission = 'denied' \u2500\u2500\n        try {\n            var _getNotifPerm = function() { return 'denied'; };\n            _storeOrig(_getNotifPerm, 'get permission');\n            Object.defineProperty(Notification, 'permission', {\n                get: _getNotifPerm,\n                configurable: true,\n            });\n        } catch(e) {}\n\n        // \u2500\u2500 window.chrome \u2500\u2500\n        try {\n            if (!window.chrome) window.chrome = {};\n            if (!window.chrome.runtime) {\n                window.chrome.runtime = {\n                    connect: function() {},\n                    sendMessage: function() {},\n                };\n            }\n            delete window.chrome.csi;\n            delete window.chrome.loadTimes;\n        } catch(e) {}\n\n        // \u2500\u2500 SharedArrayBuffer polyfill \u2500\u2500\n        if (typeof SharedArrayBuffer === 'undefined') {\n            Object.defineProperty(window, 'SharedArrayBuffer', {\n                value: function SharedArrayBuffer(length) {\n                    return new ArrayBuffer(length);\n                },\n                writable: true,\n                configurable: true,\n                enumerable: false,\n            });\n            Object.defineProperty(SharedArrayBuffer, Symbol.hasInstance, {\n                value: function(instance) {\n                    return instance instanceof ArrayBuffer;\n                },\n            });\n        }\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 1. NAVIGATOR\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        var _nav = {\n            userAgent: \"Mozilla/5.0 (Linux; Android 13; Pixel 7 Build/TD1A.220804.009.A2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.7559.172 Mobile Safari/537.36\",\n            appVersion: \"5.0 (Linux; Android 13; Pixel 7 Build/TD1A.220804.009.A2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.7559.172 Mobile Safari/537.36\",\n            platform: \"Linux armv8l\",\n            hardwareConcurrency: 8,\n            deviceMemory: 8,\n            maxTouchPoints: 5,\n            languages: Object.freeze([\"en-US\", 'en']),\n            language: \"en-US\",\n            vendor: 'Google Inc.',\n            product: 'Gecko',\n            productSub: '20030107',\n            pdfViewerEnabled: false,\n        };\n        for (var _k in _nav) {\n            _def(Navigator.prototype, _k, _nav[_k]);\n        }\n\n        // \u2500\u2500 navigator.connection \u2500\u2500\n        try {\n            var _getEffType = function() { return '4g'; };\n            var _getConnType = function() { return 'cellular'; };\n            var _getDownlink = function() { return 10; };\n            var _getRtt = function() { return 50; };\n            var _getSaveData = function() { return false; };\n            var _getOnchange = function() { return null; };\n            _storeOrig(_getEffType, 'get effectiveType');\n            _storeOrig(_getConnType, 'get type');\n            _storeOrig(_getDownlink, 'get downlink');\n            _storeOrig(_getRtt, 'get rtt');\n            _storeOrig(_getSaveData, 'get saveData');\n            _storeOrig(_getOnchange, 'get onchange');\n            var _connP = { onchange: null };\n            var _conn = Object.create(NetworkInformation.prototype, {\n                effectiveType: { get: _getEffType, enumerable: true },\n                type: { get: _getConnType, enumerable: true },\n                downlink: { get: _getDownlink, enumerable: true },\n                rtt: { get: _getRtt, enumerable: true },\n                saveData: { get: _getSaveData, enumerable: true },\n                onchange: { get: _getOnchange, set: function(v) { _connP.onchange = v; }, enumerable: true },\n            });\n            _def(Navigator.prototype, 'connection', _conn);\n        } catch(e) {\n            try {\n                _def(Navigator.prototype, 'connection', {\n                    effectiveType: '4g', type: 'cellular', downlink: 10, rtt: 50,\n                    saveData: false, onchange: null,\n                    addEventListener: function() {}, removeEventListener: function() {},\n                    dispatchEvent: function() { return true; },\n                });\n            } catch(e2) {}\n        }\n\n        // \u2500\u2500 navigator.getBattery() \u2500\u2500\n        try {\n            var _battStartLevel = (60 + (_rng() % 30)) / 100;\n            var _battStartTime = Date.now();\n            var _battDischTime = Math.floor((_battStartLevel * 100) / 0.15 * 60);\n            var _batt = {\n                charging: false, chargingTime: Infinity,\n                dischargingTime: _battDischTime, level: _battStartLevel,\n                onchargingchange: null, onchargingtimechange: null,\n                ondischargingtimechange: null, onlevelchange: null,\n                addEventListener: function(type, cb) { this['on' + type] = cb; },\n                removeEventListener: function(type) { this['on' + type] = null; },\n                dispatchEvent: function() { return true; },\n            };\n            setInterval(function() {\n                var elapsed = (Date.now() - _battStartTime) / 60000;\n                var drained = elapsed * 0.15 / 100;\n                var newLevel = Math.max(0.15, _battStartLevel - drained);\n                if (newLevel <= 0.15 && !_batt.charging) {\n                    _batt.charging = true;\n                    _batt.chargingTime = 3600;\n                    _batt.dischargingTime = Infinity;\n                    if (_batt.onchargingchange) { try { _batt.onchargingchange(new Event('chargingchange')); } catch(e2){} }\n                }\n                if (newLevel !== _batt.level) {\n                    _batt.level = Math.round(newLevel * 100) / 100;\n                    if (!_batt.charging) {\n                        _batt.dischargingTime = Math.max(0, Math.floor((_batt.level * 100) / 0.15 * 60));\n                    }\n                    if (_batt.onlevelchange) { try { _batt.onlevelchange(new Event('levelchange')); } catch(e2){} }\n                }\n            }, 30000);\n            Navigator.prototype.getBattery = function() { return Promise.resolve(_batt); };\n            _storeOrig(Navigator.prototype.getBattery, 'getBattery');\n        } catch(e) {}\n\n        // \u2500\u2500 navigator.userAgentData (Client Hints JS API) \u2500\u2500\n        try {\n            var _uaBrands = Object.freeze([\n                Object.freeze({ brand: 'Chromium', version: '144' }),\n                Object.freeze({ brand: 'Google Chrome', version: '144' }),\n                Object.freeze({ brand: 'Not_A Brand', version: '24' }),\n            ]);\n            var _uaFullVersionList = Object.freeze([\n                Object.freeze({ brand: 'Chromium', version: '144.0.7559.172' }),\n                Object.freeze({ brand: 'Google Chrome', version: '144.0.7559.172' }),\n                Object.freeze({ brand: 'Not_A Brand', version: '24.0.0.0' }),\n            ]);\n            var _uaData = Object.create(null);\n            var _getUABrands = function() { return _uaBrands; };\n            var _getUAMobile = function() { return true; };\n            var _getUAPlatform = function() { return 'Android'; };\n            _storeOrig(_getUABrands, 'get brands');\n            _storeOrig(_getUAMobile, 'get mobile');\n            _storeOrig(_getUAPlatform, 'get platform');\n            Object.defineProperties(_uaData, {\n                brands: { get: _getUABrands, enumerable: true },\n                mobile: { get: _getUAMobile, enumerable: true },\n                platform: { get: _getUAPlatform, enumerable: true },\n            });\n            _uaData.getHighEntropyValues = function(hints) {\n                return Promise.resolve({\n                    brands: _uaBrands,\n                    mobile: true,\n                    platform: 'Android',\n                    platformVersion: \"13\",\n                    architecture: 'arm',\n                    bitness: '64',\n                    model: \"Pixel 7\",\n                    uaFullVersion: '144.0.7559.172',\n                    fullVersionList: _uaFullVersionList,\n                });\n            };\n            _storeOrig(_uaData.getHighEntropyValues, 'getHighEntropyValues');\n            _uaData.toJSON = function() {\n                return { brands: _uaBrands, mobile: true, platform: 'Android' };\n            };\n            _storeOrig(_uaData.toJSON, 'toJSON');\n            Object.defineProperty(_uaData, Symbol.toStringTag, {\n                value: 'NavigatorUAData', configurable: true, writable: false, enumerable: false,\n            });\n            try {\n                if (typeof NavigatorUAData !== 'undefined') {\n                    Object.setPrototypeOf(_uaData, NavigatorUAData.prototype);\n                }\n            } catch(e) {}\n            _def(Navigator.prototype, 'userAgentData', _uaData);\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 2. SCREEN, DISPLAY & VIEWPORT\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        var _scr = {\n            width: 1080,\n            height: 2400,\n            availWidth: 1080,\n            availHeight: 2337,\n            availTop: 0, availLeft: 0,\n            colorDepth: 24, pixelDepth: 24,\n        };\n        for (var _sk in _scr) {\n            _def(Screen.prototype, _sk, _scr[_sk]);\n        }\n\n        try { _def(Screen.prototype, 'isExtended', false); } catch(e) {}\n        try { _def(window, 'devicePixelRatio', 2.625); } catch(e) {}\n\n        try {\n            var _getOrientType = function() { return 'portrait-primary'; };\n            var _getOrientAngle = function() { return 0; };\n            _storeOrig(_getOrientType, 'get type');\n            _storeOrig(_getOrientAngle, 'get angle');\n            Object.defineProperty(ScreenOrientation.prototype, 'type', {\n                get: _getOrientType, configurable: false,\n            });\n            Object.defineProperty(ScreenOrientation.prototype, 'angle', {\n                get: _getOrientAngle, configurable: false,\n            });\n        } catch(e) {}\n\n        // \u2500\u2500 Window viewport dimensions (CSS pixels) \u2500\u2500\n        var _vpW = 411;\n        var _vpH = 786;\n        try {\n            var _getInnerW = function() { return _vpW; };\n            var _getInnerH = function() { return _vpH; };\n            var _getOuterW = function() { return _vpW; };\n            var _getOuterH = function() { return _vpH; };\n            _storeOrig(_getInnerW, 'get innerWidth');\n            _storeOrig(_getInnerH, 'get innerHeight');\n            _storeOrig(_getOuterW, 'get outerWidth');\n            _storeOrig(_getOuterH, 'get outerHeight');\n            Object.defineProperty(window, 'innerWidth', {\n                get: _getInnerW, configurable: false, enumerable: true,\n            });\n            Object.defineProperty(window, 'innerHeight', {\n                get: _getInnerH, configurable: false, enumerable: true,\n            });\n            Object.defineProperty(window, 'outerWidth', {\n                get: _getOuterW, configurable: false, enumerable: true,\n            });\n            Object.defineProperty(window, 'outerHeight', {\n                get: _getOuterH, configurable: false, enumerable: true,\n            });\n        } catch(e) {}\n\n        // \u2500\u2500 document.documentElement.clientWidth/clientHeight \u2500\u2500\n        try {\n            var _getDocCW = function() { return _vpW; };\n            var _getDocCH = function() { return _vpH; };\n            _storeOrig(_getDocCW, 'get clientWidth');\n            _storeOrig(_getDocCH, 'get clientHeight');\n            function _patchDocEl() {\n                if (!document.documentElement) return false;\n                try {\n                    Object.defineProperty(document.documentElement, 'clientWidth', {\n                        get: _getDocCW, configurable: true,\n                    });\n                    Object.defineProperty(document.documentElement, 'clientHeight', {\n                        get: _getDocCH, configurable: true,\n                    });\n                } catch(e) {}\n                return true;\n            }\n            if (!_patchDocEl()) {\n                var _docObs = new MutationObserver(function(m, obs) {\n                    if (_patchDocEl()) obs.disconnect();\n                });\n                _docObs.observe(document, { childList: true });\n            }\n        } catch(e) {}\n\n        // \u2500\u2500 visualViewport API \u2500\u2500\n        try {\n            if (window.visualViewport) {\n                var _getVVW = function() { return _vpW; };\n                var _getVVH = function() { return _vpH; };\n                var _getVVScale = function() { return 1; };\n                var _getVVZero = function() { return 0; };\n                _storeOrig(_getVVW, 'get width');\n                _storeOrig(_getVVH, 'get height');\n                _storeOrig(_getVVScale, 'get scale');\n                _storeOrig(_getVVZero, 'get offsetLeft');\n                Object.defineProperty(window.visualViewport, 'width', { get: _getVVW, configurable: false, enumerable: true });\n                Object.defineProperty(window.visualViewport, 'height', { get: _getVVH, configurable: false, enumerable: true });\n                Object.defineProperty(window.visualViewport, 'scale', { get: _getVVScale, configurable: false, enumerable: true });\n                Object.defineProperty(window.visualViewport, 'offsetLeft', { get: _getVVZero, configurable: false, enumerable: true });\n                Object.defineProperty(window.visualViewport, 'offsetTop', { get: _getVVZero, configurable: false, enumerable: true });\n                Object.defineProperty(window.visualViewport, 'pageLeft', { get: _getVVZero, configurable: false, enumerable: true });\n                Object.defineProperty(window.visualViewport, 'pageTop', { get: _getVVZero, configurable: false, enumerable: true });\n            }\n        } catch(e) {}\n\n        // \u2500\u2500 matchMedia override \u2500\u2500\n        try {\n            var _origMatchMedia = window.matchMedia.bind(window);\n            window.matchMedia = function(query) {\n                if (typeof query === 'string') {\n                    query = query.replace(/device-width/g, 'width').replace(/device-height/g, 'height');\n                }\n                return _origMatchMedia(query);\n            };\n            _storeOrig(window.matchMedia, 'matchMedia');\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 3. WEBGL \u2014 Renderer/Vendor + Numeric Parameters\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        var _glR = \"Mali-G710 MC10\";\n        var _glV = \"ARM\";\n        var _gpuP = {\n    'MAX_TEXTURE_SIZE': 4096,\n    'MAX_CUBE_MAP_TEXTURE_SIZE': 4096,\n    'MAX_RENDERBUFFER_SIZE': 4096,\n    'MAX_VIEWPORT_DIMS': [4096, 4096],\n    'MAX_3D_TEXTURE_SIZE': 1024,\n    'MAX_ARRAY_TEXTURE_LAYERS': 1024,\n    'ALIASED_POINT_SIZE_RANGE': [1, 1024],\n    'ALIASED_LINE_WIDTH_RANGE': [1, 1],\n    'MAX_TEXTURE_IMAGE_UNITS': 16,\n    'MAX_COMBINED_TEXTURE_IMAGE_UNITS': 80,\n    'MAX_VERTEX_TEXTURE_IMAGE_UNITS': 16,\n    'MAX_FRAGMENT_UNIFORM_VECTORS': 1024,\n    'MAX_VERTEX_UNIFORM_VECTORS': 1024,\n    'MAX_VERTEX_ATTRIBS': 16,\n    'MAX_VERTEX_UNIFORM_COMPONENTS': 16384,\n    'MAX_VERTEX_UNIFORM_BLOCKS': 16,\n    'MAX_VERTEX_OUTPUT_COMPONENTS': 124,\n    'MAX_VARYING_VECTORS': 31,\n    'MAX_VARYING_COMPONENTS': 120,\n    'MAX_FRAGMENT_UNIFORM_COMPONENTS': 16384,\n    'MAX_FRAGMENT_UNIFORM_BLOCKS': 16,\n    'MAX_FRAGMENT_INPUT_COMPONENTS': 124,\n    'MAX_DRAW_BUFFERS': 8,\n    'MAX_COLOR_ATTACHMENTS': 8,\n    'MAX_SAMPLES': 4,\n    'MAX_UNIFORM_BUFFER_BINDINGS': 72,\n    'MAX_UNIFORM_BLOCK_SIZE': 65536,\n    'MAX_COMBINED_UNIFORM_BLOCKS': 60,\n    'MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS': 507904,\n    'MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS': 507904,\n    'MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS': 128,\n    'MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS': 4,\n    'MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS': 4,\n    'MIN_PROGRAM_TEXEL_OFFSET': -8,\n    'MAX_PROGRAM_TEXEL_OFFSET': 7,\n    'MAX_TEXTURE_LOD_BIAS': 4,\n    'UNIFORM_BUFFER_OFFSET_ALIGNMENT': 16\n  };\n\n        var _glParamMap = {\n            0x0D33: 'MAX_TEXTURE_SIZE',\n            0x851C: 'MAX_CUBE_MAP_TEXTURE_SIZE',\n            0x84E8: 'MAX_RENDERBUFFER_SIZE',\n            0x0D3A: 'MAX_VIEWPORT_DIMS',\n            0x8073: 'MAX_3D_TEXTURE_SIZE',\n            0x88FF: 'MAX_ARRAY_TEXTURE_LAYERS',\n            0x846D: 'ALIASED_POINT_SIZE_RANGE',\n            0x846E: 'ALIASED_LINE_WIDTH_RANGE',\n            0x8872: 'MAX_TEXTURE_IMAGE_UNITS',\n            0x8B4D: 'MAX_COMBINED_TEXTURE_IMAGE_UNITS',\n            0x8B4C: 'MAX_VERTEX_TEXTURE_IMAGE_UNITS',\n            0x8DFD: 'MAX_FRAGMENT_UNIFORM_VECTORS',\n            0x8DFE: 'MAX_VERTEX_UNIFORM_VECTORS',\n            0x8869: 'MAX_VERTEX_ATTRIBS',\n            0x8DFC: 'MAX_VARYING_VECTORS',\n            0x8824: 'MAX_DRAW_BUFFERS',\n            0x8CDF: 'MAX_COLOR_ATTACHMENTS',\n            0x8D57: 'MAX_SAMPLES',\n        };\n\n        function _wrapGL(proto) {\n            if (!proto || !proto.getParameter) return;\n            var _orig = proto.getParameter;\n            proto.getParameter = function(p) {\n                if (p === 0x9246) return _glR;\n                if (p === 0x9245) return _glV;\n                if (p === 0x1F01) return _glR;\n                if (p === 0x1F00) return _glV;\n                var _key = _glParamMap[p];\n                if (_key && _gpuP.hasOwnProperty(_key)) {\n                    var _val = _gpuP[_key];\n                    if (Array.isArray(_val)) {\n                        if (_key.indexOf('RANGE') >= 0 || _key.indexOf('WIDTH') >= 0) {\n                            return new Float32Array(_val);\n                        }\n                        return new Int32Array(_val);\n                    }\n                    return _val;\n                }\n                return _orig.call(this, p);\n            };\n            _storeOrig(proto.getParameter, 'getParameter');\n        }\n        try { _wrapGL(WebGLRenderingContext.prototype); } catch(e) {}\n        try { _wrapGL(WebGL2RenderingContext.prototype); } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 4. CANVAS FINGERPRINT NOISE\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        try {\n            var _origToDU = HTMLCanvasElement.prototype.toDataURL;\n            HTMLCanvasElement.prototype.toDataURL = function() {\n                try {\n                    var ctx = this.getContext && this.getContext('2d');\n                    if (ctx && this.width > 0 && this.height > 0 && this.width < 4000) {\n                        var img = ctx.getImageData(0, 0, Math.min(this.width, 64), Math.min(this.height, 64));\n                        var d = img.data;\n                        for (var i = 0; i < d.length; i += 4) {\n                            d[i] = (d[i] + (_rng() & 1)) & 0xFF;\n                        }\n                        ctx.putImageData(img, 0, 0);\n                    }\n                } catch(ex) {}\n                return _origToDU.apply(this, arguments);\n            };\n            _storeOrig(HTMLCanvasElement.prototype.toDataURL, 'toDataURL');\n        } catch(e) {}\n\n        try {\n            var _origGID = CanvasRenderingContext2D.prototype.getImageData;\n            CanvasRenderingContext2D.prototype.getImageData = function() {\n                var data = _origGID.apply(this, arguments);\n                try {\n                    var d = data.data;\n                    for (var i = 0; i < d.length; i += 4) {\n                        d[i] = (d[i] + (_rng() & 1)) & 0xFF;\n                    }\n                } catch(ex) {}\n                return data;\n            };\n            _storeOrig(CanvasRenderingContext2D.prototype.getImageData, 'getImageData');\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 5. AUDIO FINGERPRINT NOISE\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        try {\n            var _origSR = OfflineAudioContext.prototype.startRendering;\n            OfflineAudioContext.prototype.startRendering = function() {\n                return _origSR.call(this).then(function(buf) {\n                    try {\n                        var ch = buf.getChannelData(0);\n                        for (var i = 0; i < ch.length; i += 100) {\n                            ch[i] += _noiseF();\n                        }\n                    } catch(ex) {}\n                    return buf;\n                });\n            };\n            _storeOrig(OfflineAudioContext.prototype.startRendering, 'startRendering');\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 6. SPEECHSYNTHESIS\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        try {\n            var _fakeVoices = null;\n            function _buildVoices() {\n                if (_fakeVoices) return _fakeVoices;\n                var _vd = [\n                    ['Google US English', 'en-US', true],\n                    ['Google UK English Female', 'en-GB', false],\n                    ['Google UK English Male', 'en-GB', false],\n                    ['Google espa\u00f1ol', 'es-ES', false],\n                    ['Google fran\u00e7ais', 'fr-FR', false],\n                    ['Google Deutsch', 'de-DE', false],\n                    ['Google italiano', 'it-IT', false],\n                ];\n                _fakeVoices = _vd.map(function(d) {\n                    return Object.freeze({\n                        name: d[0], lang: d[1], default: d[2],\n                        localService: true, voiceURI: d[0],\n                    });\n                });\n                Object.freeze(_fakeVoices);\n                return _fakeVoices;\n            }\n            SpeechSynthesis.prototype.getVoices = function() { return _buildVoices(); };\n            _storeOrig(SpeechSynthesis.prototype.getVoices, 'getVoices');\n            setTimeout(function() {\n                try {\n                    if (window.speechSynthesis) {\n                        window.speechSynthesis.dispatchEvent(new Event('voiceschanged'));\n                    }\n                } catch(e) {}\n            }, 50);\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 7. TIMING MITIGATION\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        try {\n            Performance.prototype.now = function() {\n                return Math.round(_origPerfNow.call(this) * 10) / 10;\n            };\n            _storeOrig(Performance.prototype.now, 'now');\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 8. WEBRTC + HARDENING\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        try {\n            var _origRTC = window.RTCPeerConnection;\n            if (_origRTC) {\n                window.RTCPeerConnection = function(config) {\n                    if (!config) config = {};\n                    config.iceServers = [];\n                    return new _origRTC(config);\n                };\n                window.RTCPeerConnection.prototype = _origRTC.prototype;\n            }\n        } catch(e) {}\n\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // 9. ADDITIONAL SPOOFS\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n        // \u2500\u2500 MediaDevices.enumerateDevices() \u2500\u2500\n        try {\n            if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n                var _fakeDevices = [\n                    { deviceId: 'default', kind: 'audioinput', label: 'Bottom Microphone', groupId: 'mic0' },\n                    { deviceId: 'cam0', kind: 'videoinput', label: 'camera2 0, facing back', groupId: 'cam0' },\n                    { deviceId: 'cam1', kind: 'videoinput', label: 'camera2 1, facing front', groupId: 'cam1' },\n                    { deviceId: 'default', kind: 'audiooutput', label: 'Earpiece', groupId: 'spk0' },\n                    { deviceId: 'spk1', kind: 'audiooutput', label: 'Speaker', groupId: 'spk1' },\n                ];\n                _fakeDevices = _fakeDevices.map(function(d) {\n                    var obj = Object.create(MediaDeviceInfo.prototype);\n                    Object.defineProperties(obj, {\n                        deviceId: { get: function() { return d.deviceId; }, enumerable: true },\n                        kind: { get: function() { return d.kind; }, enumerable: true },\n                        label: { get: function() { return d.label; }, enumerable: true },\n                        groupId: { get: function() { return d.groupId; }, enumerable: true },\n                        toJSON: { value: function() { return d; } },\n                    });\n                    return obj;\n                });\n                navigator.mediaDevices.enumerateDevices = function() {\n                    return Promise.resolve(_fakeDevices);\n                };\n                _storeOrig(navigator.mediaDevices.enumerateDevices, 'enumerateDevices');\n            }\n        } catch(e) {}\n\n        // \u2500\u2500 navigator.permissions.query() \u2500\u2500\n        try {\n            if (navigator.permissions && navigator.permissions.query) {\n                var _origPermQuery = navigator.permissions.query.bind(navigator.permissions);\n                var _permMap = {\n                    'geolocation': 'granted', 'notifications': 'denied',\n                    'camera': 'prompt', 'microphone': 'prompt',\n                    'accelerometer': 'granted', 'gyroscope': 'granted',\n                    'magnetometer': 'granted', 'midi': 'prompt',\n                    'clipboard-read': 'prompt', 'clipboard-write': 'granted',\n                };\n                navigator.permissions.query = function(desc) {\n                    var name = desc && desc.name;\n                    if (name && _permMap[name] !== undefined) {\n                        return Promise.resolve({ state: _permMap[name], onchange: null,\n                            addEventListener: function(){}, removeEventListener: function(){},\n                            dispatchEvent: function(){ return true; } });\n                    }\n                    return _origPermQuery(desc);\n                };\n                _storeOrig(navigator.permissions.query, 'query');\n            }\n        } catch(e) {}\n\n        // \u2500\u2500 navigator.storage.estimate() \u2500\u2500\n        try {\n            if (navigator.storage && navigator.storage.estimate) {\n                navigator.storage.estimate = function() {\n                    var totalGB = 8 * 4;\n                    var usedGB = 1.2 + (_rng() % 50) / 10;\n                    return Promise.resolve({\n                        quota: totalGB * 1024 * 1024 * 1024,\n                        usage: Math.floor(usedGB * 1024 * 1024 * 1024),\n                        usageDetails: {},\n                    });\n                };\n                _storeOrig(navigator.storage.estimate, 'estimate');\n            }\n        } catch(e) {}\n\n        // \u2500\u2500 WebGL extensions \u2500\u2500\n        try {\n            var _dExts = ['WEBGL_debug_renderer_info', 'WEBGL_debug_shaders',\n                'EXT_disjoint_timer_query', 'EXT_disjoint_timer_query_webgl2'];\n            var _mExts = ['EXT_color_buffer_half_float', 'OES_texture_half_float_linear',\n                'WEBGL_compressed_texture_astc', 'WEBGL_compressed_texture_etc',\n                'EXT_texture_filter_anisotropic'];\n            function _patchGLExts(proto) {\n                var _origGetExts = proto.getSupportedExtensions;\n                if (!_origGetExts) return;\n                proto.getSupportedExtensions = function() {\n                    var exts = _origGetExts.call(this);\n                    if (!exts) return exts;\n                    exts = exts.filter(function(e) { return _dExts.indexOf(e) === -1; });\n                    for (var i = 0; i < _mExts.length; i++) {\n                        if (exts.indexOf(_mExts[i]) === -1) exts.push(_mExts[i]);\n                    }\n                    return exts;\n                };\n            }\n            if (window.WebGLRenderingContext) _patchGLExts(WebGLRenderingContext.prototype);\n            if (window.WebGL2RenderingContext) _patchGLExts(WebGL2RenderingContext.prototype);\n        } catch(e) {}\n\n        // \u2500\u2500 Block desktop-only APIs \u2500\u2500\n        try { if (navigator.bluetooth) _def(Navigator.prototype, 'bluetooth', undefined); } catch(e) {}\n        try { if (navigator.usb) _def(Navigator.prototype, 'usb', undefined); } catch(e) {}\n        try {\n            if (Navigator.prototype.getGamepads) {\n                Navigator.prototype.getGamepads = function() { return []; };\n                _storeOrig(Navigator.prototype.getGamepads, 'getGamepads');\n            }\n        } catch(e) {}\n        try {\n            Navigator.prototype.vibrate = function() { return true; };\n            _storeOrig(Navigator.prototype.vibrate, 'vibrate');\n        } catch(e) {}\n\n})();";
    var _d = document.createElement('div');
    _d.setAttribute('onclick', _p);
    (document.documentElement || document).appendChild(_d);
    _d.click();
    _d.remove();
})();
